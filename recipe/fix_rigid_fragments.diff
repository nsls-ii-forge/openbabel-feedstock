diff --git a/data/rigid-fragments-index.txt b/data/rigid-fragments-index.txt
index 1b29611f7..487ff5156 100644
--- a/data/rigid-fragments-index.txt
+++ b/data/rigid-fragments-index.txt
@@ -208,8 +208,6 @@ O=C1[C@@H]2CNC[C@H]1[C@H]1N[C@@H]2c2ccccc2OCCOCCOc2c1cccc2 296723
 N/C(=C\1/C(=O)C[C@H]2[C@](C1=O)(O)C(=C1[C@H](C2)[C@](C)(O)c2c(C1=O)c(O)ccc2)O)/O 297732
 CN1CC(=C)C(=O)[C@]2(C1)C[C@H]1N([C@]32C(=O)c2c4c3cccc4ccc2)CCCC1 298725
 CN1CC(=C)C(=O)[C@@]2(C1)C[C@@H]1N([C@@]32C(=O)c2c4c3cccc4ccc2)CCCC1 299721
-CC1=CC2=N3C1=Cc1cc(c4n1*13N3=C(C=c5n1c(=C2)cc5C)C(=CC3=C4)C)C 300711
-CC1=CC2=Cc3n4*56N2=C1C=c1cc(c(=CC2=N6C(=Cc4cc3C)C=C2C)n51)C 301699
 C1=CS/C(=C/2\c3sc4c(-c5c(/C/4=C\4/SC=CS4)cccc5)c3-c3c2cccc3)/S1 302691
 n1ncc2c(c1)cc1c(c2)cc2c(c1)c1cccc3c1c1c2cccc1cc3 303673
 n1cc2nc(c1)oc1ccccc1oc1nc(oc3c(o2)cccc3)cnc1 304614
@@ -312,7 +310,6 @@ CN1Cc2c3OCOc3ccc2-c2c1c1cc3OCOc3cc1cc2 391637
 CN1Cc2c3OCOc3ccc2-c2c1c1cc3OCOc3cc1cc2 392476
 CN1CC[C@@]2([C@@]31C(=O)Nc1c3cccc1)Cc1ccccc1OC2=O 393326
 CC1=C2[C@@H](O)C(=O)[C@]3([C@H](C[C@](CC1)(C2(C)C)O)[C@@H]1CO[C@@H]1C[C@@H]3O)C 394206
-C1=CC2=N3C1=Cc1ccc4n1*13N3=C(C=CC3=C4)C=c3n1c(=C2)cc3 395060
 c1ccc2c(c1)/[C-]=[C-]\c1ccccc1/[C-]=[C-]/c1c(/[C-]=[C-]\2)cccc1 395924
 c1ccc2-c3ccccc3-c3c(-c4c(-c2c1)cccc4)cccc3 396735
 c1cc2oc1/C=c\1/cc/c(=C/c3ccc(/C=c/4\o/c(=C\2)/cc4)o3)/o1 397560
@@ -2568,7 +2565,6 @@ C=C1CCCc2c1cccc2 1496355
 C=C1CCC[C@]2([C@H]1CCC2)C 1496733
 C=C1CCC[C@]2([C@H]1CC=C2)C 1497112
 C=C1CCC[C@]2([C@@H]1CCC2)C 1497491
-C=C1CCCC2(C1CCC2)C 1497862
 C=C1C=Cc2c(O1)cccc2 1498234
 C=C1C(=O)Oc2c1cccc2 1498606
 C=C1C(=O)Nc2c1cccc2 1498978
@@ -2765,7 +2761,6 @@ O[C@@H]1C=C[C@@H]2C[C@H]1OCC2 1566435
 ON1C(C)(C)C=CC1(C)C 1566775
 OCC#Cc1ccccc1 1567109
 OC1Cc2c(C1)cccc2 1567446
-OC1CC(=CC(C1)(C)C)C 1567786
 OC1C(=O)NC(=O)NC1=O 1568126
 OC1=C[C@H]2[C@@H](C1)C=C(C2)O 1568476
 OC1=C[C+](O)CC(C1)(C)C 1568819
@@ -3469,7 +3464,6 @@ O[C@@H]1CCC(OC1)(C)C 1799645
 OCC#Cc1cccs1 1799946
 OC1CCS(=O)(=O)CC1 1800253
 OC1CCCCCCC1 1800554
-OC1C(O)COCC1O 1800856
 OC1=C[C+](C(=C)C=C1)O 1801166
 OC1=CC(=O)C(=C)C=C1 1801474
 O=c1occcc1C#N 1801776
@@ -3496,7 +3490,6 @@ O=C1NC[C@]21CCCN2 1807993
 O=C1NCN2[C@H]1CCC2 1808300
 O=C1NCCC(O1)(C)C 1808605
 O=C1NCC(CO1)(C)C 1808910
-O=C1NC2C(N1)CSC2 1809215
 O=C1NC(NC1=O)(Cl)Cl 1809524
 O=C1C[C@H]2[C@@H](O1)OCC2 1809840
 O=C1C[C@@H]2CC[C@H](C1)N2 1810154
@@ -4596,7 +4589,6 @@ O[C@@H]1CC(=O)OC1 2117608
 O[C@@H]1CC(=O)NC1 2117850
 O[C@@H]1C=CC(=O)O1 2118093
 OC1COCOC1 2118327
-OC1COCC1O 2118561
 OC1CC[NH2+]CC1 2118800
 OC1CCOCC1 2119034
 OC1CCNCC1 2119268
@@ -4632,7 +4624,6 @@ O=P1OCCCO1 2126173
 O=C[O-][H]OC=O 2126413
 O=C[O-][H+][O]=CN 2126655
 O=C[O-][H+][O-]C=O 2126898
-O=C1ccC(=O)N1 2127136
 O=C1[N-][N-]=CN=N1 2127379
 O=C1SCC(=O)N1 2127617
 O=C1ON=CC1=C 2127855
@@ -5202,7 +5193,6 @@ O[C@@H]1CCCO1 2258460
 O[C@@H]1CCCN1 2258666
 O[C@@H]1CCC=C1 2258873
 O[C@@H]1CC=NN1 2259080
-OC1COCC1 2259281
 OC1CCCC1 2259482
 O=s1cccc1 2259684
 O=c1scn[nH]1 2259890
@@ -5550,7 +5540,6 @@ C1=C[P@@]23=[P@@]1(N2)N3 2329693
 C1=C[CH-]C=C[CH-]1 2329906
 C1=C[C@@H]2[C@H](O1)C2 2330121
 C1=CCC=CC1 2330324
-C1=CC=C[NH2]=C1 2330532
 C1=CC=C[NH+]=[BH-]1 2330744
 C1=CC=C[CH+]C1 2330951
 C/C(=C\C#N)/O 2331157
@@ -5642,7 +5631,6 @@ c1[nH]cc[nH+]1 2342982
 [OH2][*+2]([OH2])([OH2])[OH2] 2346680
 [O-]/C=C\C#N 2346853
 [O-]/C=C/C#N 2347026
-[O-]*(=O)(=O)[O-] 2347204
 [N-]=C=CC#N 2347376
 [N-]1CCCC1 2347547
 [CH-]=C=C=C=[CH-] 2347725
diff --git a/data/rigid-fragments.txt b/data/rigid-fragments.txt
index 6dceee2b8..b4dab4b4d 100644
--- a/data/rigid-fragments.txt
+++ b/data/rigid-fragments.txt
@@ -9002,65 +9002,65 @@ CN1CC(=C)C(=O)[C@@]2(C1)C[C@@H]1N([C@@]32C(=O)c2c4c3cccc4ccc2)CCCC1
 6    -4.300     2.212     0.071
 6    -4.259     0.690     0.165
 CC1=CC2=N3C1=Cc1cc(c4n1*13N3=C(C=c5n1c(=C2)cc5C)C(=CC3=C4)C)C
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-0     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+7     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+7     A.000     0.A00     0A000
+0     A.000     0.A00     0A000
+7     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+7     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
+6     A.000     0.A00     0A000
 CC1=CC2=Cc3n4*56N2=C1C=c1cc(c(=CC2=N6C(=Cc4cc3C)C=C2C)n51)C
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-0     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+7     A.000     0A000     0.000
+0     A.000     0A000     0.000
+7     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+7     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+7     A.000     0A000     0.000
+6     A.000     0A000     0.000
 C1=CS/C(=C/2\c3sc4c(-c5c(/C/4=C\4/SC=CS4)cccc5)c3-c3c2cccc3)/S1
 6     5.405    -2.780    -0.037
 6     4.278    -3.521    -0.116
@@ -11868,31 +11868,31 @@ CC1=C2[C@@H](O)C(=O)[C@]3([C@H](C[C@](CC1)(C2(C)C)O)[C@@H]1CO[C@@H]1C[C@@H]3O)C
 8     2.300     2.585    -0.545
 6     2.104     0.487     1.696
 C1=CC2=N3C1=Cc1ccc4n1*13N3=C(C=CC3=C4)C=c3n1c(=C2)cc3
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-0     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+7     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+7     A.000     0A000     0.000
+0     A.000     0A000     0.000
+7     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+7     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
+6     A.000     0A000     0.000
 c1ccc2c(c1)/[C-]=[C-]\c1ccccc1/[C-]=[C-]/c1c(/[C-]=[C-]\2)cccc1
 6     3.609    -3.773    -0.023
 6     2.474    -4.603    -0.044
@@ -46407,17 +46407,17 @@ C=C1CCC[C@]2([C@@H]1CCC2)C
 6     2.174    -0.541     0.275
 6     0.662    -1.051    -1.797
 C=C1CCCC2(C1CCC2)C
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
 C=C1C=Cc2c(O1)cccc2
 6    -3.367    -0.738    -0.030
 6    -2.120    -0.206     0.001
@@ -48635,16 +48635,16 @@ OC1Cc2c(C1)cccc2
 6    -2.456    -0.668    -0.308
 6    -1.326    -1.377    -0.019
 OC1CC(=CC(C1)(C)C)C
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
 OC1C(=O)NC(=O)NC1=O
 8     2.370     0.014    -0.322
 6     1.185     0.019     0.432
@@ -56155,15 +56155,15 @@ OC1CCCCCCC1
 6    -0.536     1.563    -0.704
 6     0.765     1.319     0.100
 OC1C(O)COCC1O
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-8     0.000     0.000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
 OC1=C[C+](C(=C)C=C1)O
 8     2.813     0.471    -0.022
 6     1.536     0.060     0.006
@@ -56425,15 +56425,15 @@ O=C1NCC(CO1)(C)C
 6    -2.797    -0.001    -0.569
 6    -1.463     0.176     1.574
 O=C1NC2C(N1)CSC2
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
-16     0.000     0.000     0.000
-6     0.000     0.000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+7     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+7     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+16     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
 O=C1NC(NC1=O)(Cl)Cl
 8    -2.545     0.061     1.444
 6    -1.547     0.080     0.755
@@ -66562,13 +66562,13 @@ OC1COCOC1
 8    -1.132     1.146     0.173
 6     0.276     1.276    -0.078
 OC1COCC1O
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-8     0.000     0.000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
 OC1CC[NH2+]CC1
 8     1.750     0.009    -0.737
 6     1.115    -0.045     0.537
@@ -66850,13 +66850,13 @@ O=C[O-][H+][O-]C=O
 6    -2.044    -0.524    -0.013
 8    -2.458     0.628     0.005
 O=C1ccC(=O)N1
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-8     0.000     0.000     0.000
-7     0.000     0.000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
+7     Z.000     0Z000     0.000
 O=C1[N-][N-]=CN=N1
 8    -2.123    -0.007    -0.097
 6    -0.893    -0.004     0.012
@@ -71282,12 +71282,12 @@ O[C@@H]1CC=NN1
 7    -1.454     0.559    -0.174
 7    -0.209     1.066     0.164
 OC1COCC1
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-8     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
 OC1CCCC1
 8    -1.519    -0.053     0.655
 6    -0.808     0.047    -0.576
@@ -73718,12 +73718,12 @@ C1=CCC=CC1
 6    -0.502    -1.303    -0.006
 6    -1.492    -0.170     0.015
 C1=CC=C[NH2]=C1
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-6     0.000     0.000     0.000
-7     0.000     0.000     0.000
-6     0.000     0.000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
+7     Z.000     0Z000     0.000
+6     Z.000     0Z000     0.000
 C1=CC=C[NH+]=[BH-]1
 6     1.103     0.965     0.000
 6     1.374    -0.370     0.001
@@ -74293,11 +74293,11 @@ c1[nH]cc[nH+]1
 6     1.344    -0.150    -0.012
 7     2.360     0.328    -0.052
 [O-]*(=O)(=O)[O-]
-8     0.000     0.000     0.000
-0     0.000     0.000     0.000
-8     0.000     0.000     0.000
-8     0.000     0.000     0.000
-8     0.000     0.000     0.000
+8     Z.000     0Z000     0.000
+0     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
+8     Z.000     0Z000     0.000
 [N-]=C=CC#N
 7     2.198    -0.477    -0.004
 6     1.210     0.125     0.008
